<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Ebbinghaus Intelligent Remember [v1.0]</title>
<script type="text/javascript" src="js/hj_quicklogin.js"></script>
<script type="text/javascript" src="js/hj_passnew.js"></script>
<script type="text/javascript" src="js/hj_action.js"></script>
<style>
/*******************************start test start***********************************/
.choice_item_currently{padding-top:20px; color:black; padding-bottom:8px; }
.choice_item{padding-top:20px; color:#808080; clear:both; padding-bottom:8px; }
.choice_item_title{font-size:13.5pt; font-weight:bold; font-family:Verdana; font-family:Verdana; margin-bottom:8px; }
.choice_item_list{margin:0px; padding:0px; }
.choice_item_option{margin-bottom:4px; padding-left:38px; cursor:default; }
.test_page_content_div{position:relative; }
.test_page_content_div td{padding:0px; border-collapse:collapse; border-spacing:0; }
.test_page_content_div table{width:100%; }
.choice_item_option_hover{margin-bottom:4px; padding-left:38px; cursor:default; color:#2020dc; cursor:pointer; }
.choice_item_option_clicked{margin-bottom:4px; padding-left:38px; cursor:default; background-image:url('img/selected.gif'); background-repeat:no-repeat; background-position:3px 5px; color:#2020dc; }
.choice_item_option_sequence{font-size:12pt; vertical-align:top; font-family:Verdana; width:38px; }
.choice_item_option_content{padding-left:30px; line-height:18px; word-wrap: normal; word-break: break-all; white-space:normal; width:571px; font-size:10.5pt; }
</style>
<script type="text/javascript">
'use strict';
var iTest = {
    /**
     * 当前题目
     */
    cur_item: null,
    cur_item_height: null,
    floordivtop: 0,
    /**
     * 自动滚动时,禁止其他操作
     */
    runstatus: false,
    speed: 45,
    
    choice_words: [/*正确答案,选项B,选项C,选项D*/],
    /*word_id,你的答案,测试时间]
    [1001,3,1227078926],
    [1004,0,0],
    [1005,0,0],
    [1006,0,0]*/
    word_status: [], 
    allwords: null,
    init: function(){
        var me = this,
            i,
            len,
            word_status = me.word_status,
            choice_words = me.choice_words,
            allwords = me.allwords,
            str = [],
            tmp = document.getElementById('faq_tmp').innerHTML,
            startWord = -1,
            list;
        
        //生成HTML
        for (i=0,len=choice_words.length; i<len; i++) {
            str.push(
                hui.format(tmp,{
                    'index': i,
                    'wid': choice_words[i][0],
                    'b_id': choice_words[i][1],
                    'c_id': choice_words[i][2],
                    'd_id': choice_words[i][3],
                    'word': me.allwords[choice_words[i][0]]['word'], 
                    'b_word': hui.util.decode(me.allwords[choice_words[i][1]]['mean']), 
                    'c_word': hui.util.decode(me.allwords[choice_words[i][2]]['mean']), 
                    'd_word': hui.util.decode(me.allwords[choice_words[i][3]]['mean'])
                })
            );
        }
        document.getElementById('test_page_content_div').innerHTML = str.join('');
        
        //word_status是否初始化
        if (word_status.length < choice_words.length) {
            for (i=0,len=choice_words.length; i<len; i++) {
                word_status.push([choice_words[i][0],0,0]);
            }
        }
        
        me.findUntest();
    },
    findUntest: function(){
        var me = this,
            i,
            len,
            list,
            startWord = -1,
            word_status = me.word_status,
            choice_words = me.choice_words,
            front = true,
            floordivtop;
        //找到开始点
        for (i=0,len=word_status.length; i<len; i++) {
            if (word_status[i][1] == 0 && word_status[i][2] == 0) {
                startWord = word_status[i][0];
                break;
            }
        }
        //跳到当前题目
        list = document.getElementById('test_page_content_div').childNodes;
        floordivtop = 0;
        for (i=0,len=list.length; i<len; i++) {
            if(String(list[i].tagName).toUpperCase() != 'DIV') continue;
            list[i].className='choice_item';
            list[i].style.visibility = 'visible';
            
            if(front && list[i].getAttribute('wid') != startWord){ 
                floordivtop -= parseInt(list[i].offsetHeight,10);
                list[i].style.visibility = 'hidden';
            }
            if(list[i].getAttribute('wid') == startWord) 
            {
                list[i].className='choice_item_currently';
                me.cur_item = list[i];
                front = false;
            }
        }
        me.cur_item_height = -me.floordivtop + floordivtop;
        me.movefloor('pre');
                
        if (!!me.cur_item) {
            document.getElementById('wordpre').disabled = 
            (parseInt(me.cur_item.getAttribute('index'),10) > 0 ? false:  'disabled');
            document.getElementById('wordnext').disabled = 
            (parseInt(me.cur_item.getAttribute('index'),10) < me.choice_words.length-1 ? false:  'disabled');
        }
        
        if (!me.cur_item) {
            me.finishtest(); 
        }
    },
    movefloor: function(sign){
        var me = iTest,
            cur_item = me.cur_item;
        if(me.cur_item_height === null){
            me.cur_item_height = parseInt(me.cur_item.offsetHeight,10);
        }
        
        if(me.cur_item_height <= me.speed)
        {
            me.runstatus = false;
            me.floordivtop +=  (sign == 'pre' ? me.cur_item_height:  -me.cur_item_height); 
            me.cur_item_height = null;
            document.getElementById('test_page_content_div').style.top = me.floordivtop + 'px';
            
            if (sign !== 'pre') {
                me.cur_item.style.visibility = 'hidden';
                //显示下一个
                me.updateCurItem();
                if (!me.cur_item) {
                    me.finishtest(); 
                }
            }
        }
        else
        {
            me.floordivtop += (sign == 'pre' ? me.speed:  -me.speed); 
            me.cur_item_height = me.cur_item_height - me.speed;
            document.getElementById('test_page_content_div').style.top = me.floordivtop + 'px';
            window.setTimeout('iTest.movefloor("'+sign+'")', 45);
        }
    },
    shownext: function(){
        var me = this;
        if (me.runstatus) {return;}
        me.runstatus = true;
        me.speed = 45;

        if (!!me.cur_item) {
            me.movefloor();
        }
        else {
            me.finishtest(); 
        }
    },
    showpre: function(){
        var me = this;
        if (me.runstatus) {return;}
        me.runstatus = true;
        me.speed = 45;
        
        me.cur_item.className = 'choice_item';
        
        me.updateCurItem('pre');
        if (!!me.cur_item) {
            me.movefloor('pre');
        }else {
            me.finishtest(); 
        }
    },
    /**
     * 下一个cur_item
     */
    updateCurItem: function(sign){
        var me = this,
            cur_item = me.cur_item;
        
        while (cur_item) {
            cur_item = (sign == 'pre' ? cur_item.previousSibling:  cur_item.nextSibling);
            if (cur_item && cur_item.className && (cur_item.className == 'choice_item' || cur_item.className == 'choice_item_currently')) {
                cur_item.className = 'choice_item_currently';
                cur_item.style.visibility = 'visible';
                break;
            }
        }
        me.cur_item = cur_item;
        if (!!me.cur_item) {
            document.getElementById('wordpre').disabled = 
            (parseInt(me.cur_item.getAttribute('index'),10) > 0 ? false:  'disabled');
            document.getElementById('wordnext').disabled = 
            (parseInt(me.cur_item.getAttribute('index'),10) < me.choice_words.length-1 ? false:  'disabled');
        }
    },
    /**
     * 鼠标动作
     */
    mouseclick: function mouseclick(obj){
        var me = iTest,
            i,
            len,
            list,
            wid;
        me.cur_item = obj.parentNode.parentNode;
        if(me.cur_item.className != 'choice_item_currently') return;
        
        list = obj.parentNode.childNodes;
        for (i=0,len=list.length; i<len; i++) {
            if(String(list[i].tagName).toUpperCase() != 'DIV') continue;
            list[i].className = 'choice_item_option';
        }
        
        obj.className = 'choice_item_option_clicked';
        
        me.runstatus = true;
         
        wid = me.cur_item.getAttribute('wid');
        list = me.word_status;
        for (i=0,len=list.length; i<len; i++) {
            if (wid == list[i][0]){
                list[i] = [wid,obj.getAttribute('wid'),String((new Date()).getTime()).substr(0,10)];
                break;
            }
        }
        if (parseInt(me.cur_item.getAttribute('index'),10) >= me.choice_words.length-1){
            me.speed = 60;
            me.findUntest();
        }else{
            window.setTimeout(me.movefloor, 300);
        }
    },
    finishtest: function(){
        var me = this,
            str = [],
            result,
            paramstr = {},
            md5,
            i,
            len,
            wordsTable = me.word_array;
        
        paramstr.choice_words = me.choice_words;
        paramstr.word_status = me.word_status;
        paramstr.word_array = me.word_array;
        
        if(me.saveResult){
            me.saveResult(paramstr);
        }
         

    },
    saveResult: function(){}
};

</script>
<script type="text/javascript">
<!--

iTest['list_id']    = 'NaN';////args['list_id'] || 'NaN';
iTest['learn_id']   = '';//args['learn_id']; 
iTest['test_id']    = '';//args['test_id'];
iTest['date']       = '';//args['date'];
        

iTest.choice_words = [[1,1,362090,66791],[2,360976,402184,2],[3,73567,3,163374],[4,275787,4,174853],[5,359592,307246,5]];

iTest.allwords = {
"1":{"word_id":"1","word":"orange","mean":"n.柑%2C 桔%2C 橙%2C 橙色","audio":"[5CrindV]"},
"2":{"word_id":"2","word":"egg","mean":"n.蛋%2C 鸡蛋%2C 卵&&v.怂恿%2C 怂恿","audio":"[e^]"},
"3":{"word_id":"3","word":"dog","mean":"n.狗%2C 犬%2C ","audio":"[dC^]"},
"4":{"word_id":"4","word":"cat","mean":"n.猫","audio":"[kAt]"},
"5":{"word_id":"5","word":"apple","mean":"n.苹果%2C 似苹果的果实","audio":"[5Apl]"},
"66791":{"word_id":"66791","word":"cavings elevator","mean":"颖糠升运器","audio":""},
"73567":{"word_id":"73567","word":"choke in","mean":"[美俚]激动得说不出话来%2C 紧张得发呆","audio":""},
"163374":{"word_id":"163374","word":"fortescue","mean":"澳洲鳞?","audio":"[5fC:tE7skju:]"},
"174853":{"word_id":"174853","word":"girgensonine","mean":"盐蓬碱","audio":"[5^E:dVEnsE7nain]"},
"275787":{"word_id":"275787","word":"non-moral","mean":"adj.与道德无关的","audio":""},
"307246":{"word_id":"307246","word":"pit cable","mean":"矿井电缆","audio":""},
"359592":{"word_id":"359592","word":"screen process press","mean":"丝网印刷机","audio":""},
"360976":{"word_id":"360976","word":"secession","mean":"n.脱离","audio":"[si5seFEn]"},
"362090":{"word_id":"362090","word":"seed sower","mean":"播种机","audio":""},
"402184":{"word_id":"402184","word":"syndetic","mean":"[语]连结的%2C (用连接词)连接的","audio":"[sin5detik]"}
};

window.onload = function(){

        //iTest.choice_words  = me.model['choice'];
        //iTest.allwords      = me.model['allwords'];
        iTest.word_status   = [];//me.model['word_status'];
        iTest.test_time     = [];//me.model['test_time'];
        iTest.word_array    = [];//me.model['word_array'];
        
        //iTest.finishtest();
        //iTest.saveResult = hui.fn(me.saveTestResult,me);
        
        //if(iTest.choice_words.length>0){
        //    iTest.init();
        //}

    iTest.init();
}
//-->
</script>
<!-- <link rel="stylesheet" type="text/css" href="common/css/style.css" /> -->
<style type="text/css">
</style>


</head>

<body style="">
<!--target:test-->

<div id="faq_tmp" style="display:none;">
    <div id="#{wid}" class="choice_item" wid="#{wid}" index="#{index}">
        <div class="choice_item_title">#{word}</div>
        <div class="choice_item_list">
            <div class="choice_item_option" onclick="iTest.mouseclick(this)" wid="0" onmouseover="if(this.parentNode.parentNode.className=='choice_item_currently' && !iTest.runstatus){hui.addClass(this,'choice_item_option_hover');}" onmouseout="if(this.parentNode.parentNode.className=='choice_item_currently' && !iTest.runstatus){hui.removeClass(this,'choice_item_option_hover');}">
                <table>
                    <tr>
                        <td class="choice_item_option_sequence">A</td>
                        <td class="choice_item_option_content"><span>Can&#39;t remember.</span></td>
                        <td>&nbsp;</td>
                    </tr>
                </table>
            </div>
            <div class="choice_item_option" onclick="iTest.mouseclick(this)" wid="#{b_id}" onmouseover="if(this.parentNode.parentNode.className=='choice_item_currently' && !iTest.runstatus){hui.addClass(this,'choice_item_option_hover');}" onmouseout="if(this.parentNode.parentNode.className=='choice_item_currently' && !iTest.runstatus){hui.removeClass(this,'choice_item_option_hover');}">
                <table>
                    <tr>
                        <td class="choice_item_option_sequence">B</td>
                        <td class="choice_item_option_content"><span>#{b_word}</span></td>
                        <td>&nbsp;</td>
                    </tr>
                </table>
            </div>
            <div class="choice_item_option" onclick="iTest.mouseclick(this)" wid="#{c_id}" onmouseover="if(this.parentNode.parentNode.className=='choice_item_currently' && !iTest.runstatus){hui.addClass(this,'choice_item_option_hover');}" onmouseout="if(this.parentNode.parentNode.className=='choice_item_currently' && !iTest.runstatus){hui.removeClass(this,'choice_item_option_hover');}">
                <table>
                    <tr>
                        <td class="choice_item_option_sequence">C</td>
                        <td class="choice_item_option_content"><span>#{c_word}</span></td>
                        <td>&nbsp;</td>
                    </tr>
                </table>
            </div>
            <div class="choice_item_option" onclick="iTest.mouseclick(this)" wid="#{d_id}" onmouseover="if(this.parentNode.parentNode.className=='choice_item_currently' && !iTest.runstatus){hui.addClass(this,'choice_item_option_hover');}" onmouseout="if(this.parentNode.parentNode.className=='choice_item_currently' && !iTest.runstatus){hui.removeClass(this,'choice_item_option_hover');}">
                <table>
                    <tr>
                        <td class="choice_item_option_sequence">D</td>
                        <td class="choice_item_option_content"><span>#{d_word}</span></td>
                        <td>&nbsp;</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>


<div class="page_body_test" style="">
    <div style="position: absolute; z-index: 100; margin-left: 620px; margin-top: 10px;display:none">
        <button disabled="disabled" type="button" id="wordpre" onclick="iTest.showpre()">Pre</button>&nbsp;
        <button disabled="disabled" type="button" id="wordnext" onclick="iTest.shownext()">Next</button>&nbsp;&nbsp;
    </div>
    <div class="test_page_content_floor" style="overflow:hidden;">
        <div class="test_page_content_div" id="test_page_content_div">                        
        </div>
    </div>  
</div>
<div class="page_body_submit">
    <button type="button" id="finish">${Finish:lang}</button>&nbsp;
    <button type="button" id="cancel">${Cancel:lang}</button>                       
</div>


</body>

</html>
